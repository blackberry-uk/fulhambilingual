
import { createClient } from '@supabase/supabase-js';
import dotenv from 'dotenv';
dotenv.config();

const supabaseUrl = process.env.VITE_SUPABASE_URL;
const supabaseKey = process.env.SUPABASE_SERVICE_ROLE_KEY;

if (!supabaseUrl || !supabaseKey) {
    console.error('Missing VITE_SUPABASE_URL or SUPABASE_SERVICE_ROLE_KEY');
    process.exit(1);
}

const supabase = createClient(supabaseUrl, supabaseKey);

const en_content = `To:<br/><b>The Leadership of the Lycée Français Charles de Gaulle</b><br/><b>The French Embassy and Cultural Services in the United Kingdom</b><br/><b>The Governing Bodies of Fulham Bilingual School and Holy Cross School</b><br/><b>AEFE – Agence pour l’Enseignement Français à l’Étranger</b><br/><br/>London, Monday 19 January 2026<br/><br/><b>Preserving a Proven, Strategic, and Sustainable Educational Partnership</b><br/><br/>We write as parents and members of the Fulham Bilingual community to express our deep concern regarding the possible termination of the long-standing partnership between the Lycée Français Charles de Gaulle (LFCG) and Holy Cross School.<br/><br/>We fully acknowledge the financial pressures currently facing the Lycée, as well as the broader demographic challenges affecting French education in London following Brexit. However, we firmly believe that ending this partnership would be a strategic mistake—educationally, financially, and culturally—and that constructive solutions should be explored before any irreversible decision is taken.<br/><br/><b>1. Fulham Bilingual Is a Proven Feeder Into the Lycée</b><br/>Fulham Bilingual provides authentic exposure to the French education system for families who would otherwise never consider it. For many non-French households, this school is the sole entry point into French education.<br/><br/>This exposure converts directly into fee-paying enrolments at secondary level. A consistent proportion of pupils from the Holy Cross stream later join the Lycée in Sixième and continue through collège and lycée. These families go on to pay full Lycée tuition for several years—often for more than one child.<br/><br/>Conservatively calculated, a single pupil entering the Lycée in Sixième represents approximately £80,000 in secondary tuition revenue over seven years. Even assuming that only one-third of Holy Cross pupils later convert to Lycée students, the partnership generates an expected future value of approximately £720,000 per cohort (28 Holy Cross seats × one-third conversion × £80,000).<br/><br/>Ending the partnership therefore does not merely reduce access—it dismantles a functioning and measurable enrolment pipeline into the Lycée’s secondary school.<br/><br/><b>2. The Partnership Maximises UK-Funded Resources</b><br/>The Fulham Bilingual benefits from substantial UK public investment via Holy Cross School, including:<br/><ul><li>Shared administration and leadership</li><li>Highly qualified, UK-trained English teachers</li><li>Access to a strong local and regional school network</li></ul><br/>This enables the French curriculum to be delivered within a broader, well-resourced educational ecosystem that the Lycée would be unable to replicate independently without significantly higher cost and operational risk.<br/><br/>The partnership therefore represents not a financial liability, but an efficient and mutually beneficial use of complementary public resources in the UK and France.<br/><br/><b>3. Cultural Mission and Franco-British Engagement</b><br/>Beyond enrolment and finances, Fulham Bilingual fulfils a wider cultural mission. It fosters genuine Franco-British educational exchange and deep linguistic and cultural fluency among non-French children and families.<br/><br/>In a post-Brexit context, this form of educational and cultural “soft power” is not incidental—it is strategically important. The school sustains long-term engagement with the French language, values, and educational model among future generations of Europeans and non-Europeans alike.<br/><br/><b>4. Addressing Under-Filled Lycée Seats Through Outreach, Not Withdrawal</b><br/>We recognise that some of the fee-paying Lycée places within Fulham Bilingual have not always been filled, and we understand the concern that family movement between streams can contribute to this dynamic.<br/><br/>For this reason, we believe it is particularly important to explore complementary solutions alongside any structural changes—such as enhanced local outreach, clearer communication of the value of the Lycée stream, and targeted engagement with non-French families already within the bilingual ecosystem.<br/><br/>Strengthening awareness and facilitating access to available places may help stabilise enrolment and financial sustainability while preserving the partnership’s long-term role as a pathway into the Lycée’s secondary school.<br/><br/><b>Our Request</b><br/>We respectfully ask for:<br/><ul><li>A moratorium on any decision to terminate the partnership</li><li>The opening of a transparent dialogue with parents and partners</li><li>Serious consideration of financial, marketing, or hybrid solutions that preserve the bilingual model while addressing the Lycée’s constraints</li><li>A transparent review of the partnership rules to address concerns raised by the Lycée</li></ul><br/>The parent community on both sides would overwhelmingly prefer to explore sustainable solutions rather than face the permanent loss of a school model that has delivered clear educational, financial, and cultural value for over 15 years.<br/><br/>Fulham Bilingual is a thriving and well-established community with a substantial alumni base and a strong record of academic progression.<br/><br/>This partnership works. It feeds the Lycée. It broadens access. It strengthens France’s educational presence in the United Kingdom. It deserves to be strengthened—not dismantled.<br/><br/>Signed,<br/>Parents, families, alumni, and supporters of Fulham Bilingual School`;

const fr_content = `À :<br/><b>La direction du Lycée Français Charles de Gaulle</b><br/><b>L’Ambassade de France au Royaume-Uni et les services culturels</b><br/><b>Les instances dirigeantes de Fulham Bilingual School et de Holy Cross School</b><br/><b>AEFE – Agence pour l’Enseignement Français à l’Étranger</b><br/><br/>Londres, lundi 19 janvier 2026<br/><br/><b>Préserver un partenariat éducatif éprouvé, stratégique et durable</b><br/><br/>Nous écrivons en tant que parents et membres de la communauté de Fulham Bilingual afin d’exprimer notre profonde inquiétude face à l’éventuelle cessation du partenariat de longue date entre le Lycée Français Charles de Gaulle (LFCG) et Holy Cross School.<br/><br/>Nous reconnaissons pleinement les contraintes financières auxquelles le Lycée est actuellement confronté, ainsi que les défis démographiques plus larges affectant l’enseignement français à Londres depuis le Brexit. Toutefois, nous sommes convaincus que la fin de ce partenariat constituerait une erreur stratégique — sur les plans éducatif, financier et culturel — et que des solutions constructives doivent être explorées avant toute décision irréversible.<br/><br/><b>1. Fulham Bilingual constitue un vivier éprouvé pour le Lycée</b><br/>Fulham Bilingual offre une exposition authentique au système éducatif français à des familles qui, sans cela, ne l’envisageraient jamais. Pour de nombreux foyers non francophones, cette école représente l’unique point d’entrée vers l’enseignement français.<br/><br/>Cette exposition se traduit concrètement par des inscriptions payantes dans le secondaire. Une proportion régulière d’élèves issus de la filière Holy Cross rejoint ensuite le Lycée en Sixième et poursuit sa scolarité au collège puis au lycée. Ces familles acquittent alors les frais de scolarité du Lycée pendant plusieurs années — souvent pour plus d’un enfant.<br/><br/>De manière prudente, un élève entrant au Lycée en Sixième représente environ 80 000 £ de recettes de scolarité sur sept ans dans le secondaire. Même en supposant qu’un tiers seulement des élèves Holy Cross rejoignent ensuite le Lycée, le partenariat génèrerait une valeur future attendue d’environ 720 000 £ par cohorte (28 places Holy Cross × un tiers de conversion × 80 000 £).<br/><br/>Mettre fin au partenariat ne se limite donc pas à réduire l’accès : cela revient à démanteler un vivier d’inscriptions fonctionnel et mesurable pour le secondaire du Lycée.<br/><br/><b>2. Le partenariat optimise l’utilisation de ressources financées par le Royaume-Uni</b><br/>Fulham Bilingual bénéficie d’investissements publics significatifs via Holy Cross School, notamment :<br/><ul><li>une administration et une direction partagées</li><li>des enseignants d’anglais hautement qualifiés et formés au Royaume-Uni</li><li>l’accès à un réseau scolaire local et régional solide</li></ul><br/>Cela permet au programme français d’être dispensé dans un écosystème éducatif plus large et bien doté, que le Lycée ne pourrait pas reproduire seul sans coûts ni risques opérationnels nettement supérieurs.<br/><br/>Le partenariat ne constitue donc pas une charge financière, mais une utilisation efficace et complémentaire de ressources publiques britanniques et françaises.<br/><br/><b>3. Mission culturelle et engagement franco-britannique</b><br/>Au-delà des enjeux d’inscription et de finances, Fulham Bilingual remplit une mission culturelle plus large. Il favorise un véritable échange éducatif franco-britannique et développe une maîtrise linguistique et culturelle approfondie chez des enfants et familles non francophones.<br/><br/>Dans un contexte post-Brexit, cette forme de « soft power » éducatif n’est pas accessoire : elle revêt une importance stratégique. L’école contribue à maintenir un lien durable avec la langue française, ses valeurs et son modèle éducatif auprès des générations futures, européennes comme non européennes.<br/><br/><b>4. Traiter la sous-occupation de certaines places du Lycée par l’ouverture, non par le retrait</b><br/>Nous reconnaissons que certaines places payantes du Lycée au sein de Fulham Bilingual n’ont pas toujours été intégralement pourvues, et nous comprenons que les mouvements de familles entre filières puissent contribuer à cette situation.<br/><br/>C’est précisément pour cette raison qu’il nous paraît essentiel d’examiner des solutions complémentaires à toute évolution structurelle, telles qu’un renforcement de la communication locale, une meilleure valorisation de la filière Lycée, et un engagement ciblé auprès de familles non francophones déjà présentes dans l’écosystème bilingue.<br/><br/>Renforcer la visibilité et faciliter l’accès aux places disponibles pourrait contribuer à stabiliser les effectifs et la situation financière, tout en préservant le rôle du partenariat comme passerelle vers le secondaire du Lycée.<br/><br/><b>Our Request</b><br/>Nous demandons respectueusement :<br/><ul><li>un moratoire sur toute décision visant à mettre fin au partenariat</li><li>l’ouverture d’un dialogue transparent avec les parents et les partenaires</li><li>l’étude sérieuse de solutions financières, marketing ou hybrides permettant de préserver le modèle bilingue tout en répondant aux contraintes du Lycée</li><li>une revue transparente des règles du partenariat afin de répondre aux préoccupations exprimées par le Lycée</li></ul><br/>La communauté des parents, des deux côtés, préférerait très largement explorer des solutions durables plutôt que de faire face à la disparition définitive d’un modèle scolaire ayant démontré sa valeur éducative, financière et culturelle depuis plus de quinze ans.<br/><br/>Fulham Bilingual est une communauté dynamique et solidement établie, disposant d’un réseau d’anciens élèves significatif et d’un excellent historique de poursuite d’études.<br/><br/>Ce partenariat fonctionne. Il alimente le Lycée. Il élargit l’accès. Il renforce la présence éducative de la France au Royaume-Uni. Il mérite d’être consolidé — et non démantelé.<br/><br/>Signé,<br/>Les parents, familles, anciens élèves et soutiens de Fulham Bilingual School`;

async function update() {
    const { data, error } = await supabase
        .from('site_content')
        .upsert({
            key: 'petition_body',
            en_content,
            fr_content,
            updated_at: new Date().toISOString()
        }, { onConflict: 'key' });

    if (error) {
        console.error('Update failed:', error);
        process.exit(1);
    } else {
        console.log('Update successful');
        process.exit(0);
    }
}

update();
